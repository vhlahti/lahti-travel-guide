<ion-content [fullscreen]="true" color="light">
<ion-header class="ion-no-border" slot="fixed">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button
        defaultHref="/tabs/home">
    </ion-back-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<div *ngIf="product$ | async as product; else loading">
  <div *ngIf="product; else notFound">
    <!-- Hero Image -->
    <div class="hero-image" [style.backgroundImage]="'url(' + (product.productImages[0]?.originalUrl || 'assets/img/detail_placeholder.png') + ')'"></div>

    <!-- Event Description Section -->
    <div class="section-container">
      <div class="event-description">
        <h1>{{ (product.productInformations | preferredInfo)?.name }}</h1>
        <p class="company-name">{{ product.company.businessName }}</p>
        <p class="description">{{ (product.productInformations | preferredInfo)?.description }}</p>
      </div>
    </div>

    <!-- Product Details Grid (2 columns) -->
    <div class="section-container">
      <h2 class="section-title">Product Details</h2>
      <div class="grid-2">
        <div class="grid-item">
          <p class="label">Type</p>
          <p class="value">{{ (product.type | tagUnderscore) | titlecase }}</p>
        </div>
        <div class="grid-item">
          <p class="label">Pricing</p>
          <p class="value">{{ (product.productPricings[0]?.pricingType | titlecase) || '-' }}</p>
        </div>
        <div class="grid-item">
          <p class="label">Available Months</p>
          <div class="tags">
            <span *ngFor="let m of product.productAvailableMonths" class="tag">{{ m.month }}</span>
          </div>
        </div>
        <div class="grid-item">
          <p class="label">Last Updated</p>
          <p class="value">{{ product.updatedAt | date:'dd.MM.yyyy' }}</p>
        </div>
      </div>
      <a *ngIf="product.productInformations.length" [href]="product.productInformations[0].url" target="_blank" rel="noopener noreferrer" class="product-link">
        <ion-button size="md">
          <ion-icon name="link-outline"></ion-icon>
          Visit Product Webpage</ion-button>
      </a>
    </div>

    <!-- Contact Details Grid (2 columns) -->
    <div class="section-container">
      <h2 class="section-title">Contact Information</h2>
      <div class="grid-2">
        <div class="grid-item">
          <p class="label">Business</p>
          <p class="value">{{ product.company.businessName }}</p>
        </div>
        <div class="grid-item">
          <p class="label">Email</p>
          <a *ngIf="product.contactDetails[0]?.email" [href]="'mailto:' + product.contactDetails[0].email" class="contact-link">{{ product.contactDetails[0].email }}</a>
          <p *ngIf="!product.contactDetails[0]?.email" class="value">N/A</p>
        </div>
        <div class="grid-item">
          <p class="label">Address</p>
          <p class="value">{{ product.postalAddresses[0]?.streetName || '-' }}, 
            {{ product.postalAddresses[0]?.postalCode || '-' }}, 
            {{ product.postalAddresses[0]?.city || '-' }}</p>
        </div>
        <div class="grid-item">
          <p class="label">Phone</p>
          <a *ngIf="product.contactDetails[0]?.phone" [href]="'tel:' + product.contactDetails[0].phone" class="contact-link">{{ product.contactDetails[0].phone }}</a>
          <p *ngIf="!product.contactDetails[0]?.phone" class="value">N/A</p>
        </div>
      </div>
    </div>

    <!-- Tags Section -->
    <div class="section-container tags-section">
      <h2 class="section-title">Tags</h2>
      <div class="tags">
        <span *ngFor="let t of product.productTags" class="tag">{{ t.tag | tagUnderscore }}</span>
      </div>
    </div>
  </div>
</div>


<ng-template #loading>
  <div class="spinner-container">
    <ion-spinner name="lines-sharp"></ion-spinner>
  </div>
</ng-template>

<ng-template #notFound>
    <div class="ion-padding not-found">
      <p>Item not found.</p>
      <p>The item you’re looking for doesn’t exist or was removed.</p>
    </div>
</ng-template>

</ion-content>